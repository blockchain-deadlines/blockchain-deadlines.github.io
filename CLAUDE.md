# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Overview

This is a Jekyll-based static website that tracks submission deadlines for academic conferences and venues related to blockchain research, cryptography, distributed systems, security, and economics/incentives. The site displays countdown timers for upcoming deadlines and allows filtering by subject area.

## Key Commands

### Building and Running
- **Build site**: `jekyll build` (generates the site in `_site/`)
- **Serve locally**: `jekyll serve` (typically runs on http://localhost:4000)

### Conference Data Management
- **Compress conferences**: `./compress-conferences.sh` - Concatenates all YAML files from `_data/conferences_raw/` into `_data/conferences.yml`. **Must be run** after any changes to conference data files.

### Automated Conference Updates
- **Update conferences with AI**: `./chatgpt-updater.py [conference_names...]`
  - Uses GPT and Serper API to automatically update conference deadlines
  - Requires environment variables: `API_KEY_OPENAI` and `API_KEY_SERPER`
  - Optional flags:
    - `--training-data-collect`: Save interaction traces for model training
    - `--refresh`: Re-verify all provided information from official sources
    - `--model`: Specify OpenAI model (default: "gpt-5")
  - Examples:
    - Update all conferences: `./chatgpt-updater.py`
    - Update specific conferences: `./chatgpt-updater.py fc crypto`
    - With training data collection: `./chatgpt-updater.py --training-data-collect`

### Python Environment
- **Setup virtual environment**: `python3 -m venv venv && source venv/bin/activate`
- **Install dependencies**: `pip install -r requirements.txt`
- Dependencies include: openai, pydantic, requests, PyYAML, beautifulsoup4, typer

## Architecture

### Data Layer
- **Conference definitions**: Individual YAML files in `_data/conferences_raw/` (one per conference series)
- **Compiled data**: `_data/conferences.yml` (generated by `compress-conferences.sh`, used by Jekyll)
- **Subject types**: `_data/types.yml` defines the five subject areas (BC, CR, DS, SEC, EC) with their display names and colors

### Conference Data Schema
Each conference cycle in the YAML files must have:
- `id`: Unique identifier (format: `{confname}{YY}{optional-cycle}`)
- `year`: Conference year
- `title`: Short conference name
- `full_title`: Full conference name
- `link`: Official conference website URL
- `deadline`: Submission deadline (`YYYY-MM-DD HH:MM:SS` format)
- `timezone`: Timezone string (e.g., `Etc/GMT+12` for AoE, or standard IANA timezones)
- `note`: Additional information (abstract deadlines, notification dates, submission cycles)
- `place`: Conference location
- `date`: Human-readable conference dates
- `start`: Conference start date (`YYYY-MM-DD`)
- `end`: Conference end date (`YYYY-MM-DD`)
- `sub`: Array of subject codes (BC/CR/DS/SEC/EC)
- `inactive`: Boolean flag (set to true to skip automated updates)

### Frontend Architecture
- **Main page**: `index.html` - Lists all conferences with countdown timers
- **Conference detail page**: `_pages/conference.html` - Individual conference information
- **Calendar view**: `calendar.html` - Year calendar view of deadlines
- **JavaScript modules** (in `_includes/`):
  - `load_data.js`: Loads subject type data from Jekyll
  - `utils.js`: Utility functions for date/time handling
  - `multiselect_handler.js`: Subject filter multiselect logic
  - `handle_url_retrieval.js`: URL parameter handling for filtering
  - `calendar.js`: Calendar view rendering

### Time Zone Handling
- Deadlines stored in conference's native timezone
- Frontend converts to user's local timezone using moment.js and moment-timezone
- AoE (Anywhere on Earth) represented as `Etc/GMT+12`

### Filtering System
- Subject-based filtering using multiselect dropdown
- URL parameters preserve filter state (e.g., `?sub=BC,CR`)
- Click on subject badges to filter by that subject
- Past conferences automatically moved to separate section with sortable display

### Plugin System
- `_plugins/data_page_generator.rb`: Jekyll plugin that generates individual pages for each conference from YAML data

## AI-Powered Conference Updates

The `chatgpt-updater.py` script automates the tedious task of updating conference deadlines. It:
1. Reads existing conference data from `_data/conferences_raw/`
2. Uses web search (Serper API) to find the latest call-for-papers
3. Extracts deadline information from official conference websites
4. Uses structured output with Pydantic validation to ensure data integrity
5. Only trusts authoritative sources (conference websites, organizers, publishers)
6. Handles multiple submission cycles and complex deadline scenarios
7. Optionally collects training data for fine-tuning

The script prioritizes text content over HTML to reduce token usage, and implements validation to ensure timezone, date format, and field consistency.